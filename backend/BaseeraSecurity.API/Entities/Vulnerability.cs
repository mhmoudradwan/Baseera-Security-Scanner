using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace BaseeraSecurity.API.Entities;

/// <summary>
/// Vulnerability entity - كيان الثغرة
/// Represents a detected security vulnerability
/// يمثل ثغرة أمنية مكتشفة
/// </summary>
public class Vulnerability
{
    [Key]
    public int Id { get; set; }

    [ForeignKey(nameof(Scan))]
    public int ScanId { get; set; }

    [ForeignKey(nameof(Type))]
    public int TypeId { get; set; }

    [Required]
    [StringLength(500)]
    public string Title { get; set; } = string.Empty;

    [StringLength(2000)]
    public string? Description { get; set; }

    [StringLength(1000)]
    public string? Location { get; set; }

    [StringLength(2000)]
    public string? Evidence { get; set; }

    [StringLength(2000)]
    public string? Recommendation { get; set; }

    public DateTime DetectedAt { get; set; } = DateTime.UtcNow;

    // Navigation properties - خصائص التنقل
    public virtual Scan Scan { get; set; } = null!;
    public virtual VulnerabilityType Type { get; set; } = null!;
}
